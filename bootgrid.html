<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment-with-locales.min.js"></script>
</head>
<body>


<table id="grid-basic" class="table table-condensed table-hover table-striped">
    <thead>
    <tr>
        <th data-column-id="domain">Domain</th>
        <th data-column-id="status" data-align="center" data-header-align="center">Status</th>
        <th data-column-id="emails" data-formatter="emails" data-align="center" data-header-align="center">Emails</th>
        <th data-column-id="sendTemplates">Send Template</th>
        <th data-column-id="lastSent" data-formatter="lastSent" data-align="center" data-header-align="center">Last Sent</th>
        <th data-column-id="blockedTill" data-formatter="blockedTill" data-align="center" data-header-align="center">Blocked Till</th>
        <th data-column-id="actions" data-formatter="actions" data-align="center" data-header-align="center">Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>test.com</td>
        <td>NOT PARSED</td>
        <td>13</td>
        <td></td>
        <td>2017-09-10 13:56:00</td>
        <td>2017-09-13 13:12:00</td>
        <td></td>
    </tr>
    <tr>
        <td>test.com</td>
        <td>BLOCKED 60 DAYS</td>
        <td>0</td>
        <td></td>
        <td>2017-08-05 13:56:00</td>
        <td>2017-11-15 15:55:00</td>
        <td></td>
    </tr>
    </tbody>
</table>

<div id="emails" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">List of emails for domain: <strong>test.com</strong></h4>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 0;" class="list-group text-center">
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item active">info@thewowgallery.co.uk</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                    <a href="#" class="list-group-item">mail.com</a>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#grid-basic").bootgrid({
            formatters: {
                emails: ( col, row ) => {
                    const count = row.emails;
                    const current = 'info@thewowgallery.co.uk';
                    if (count > 0) {
                        return `<div data-toggle="tooltip" title="Current email: ${current}" class="btn btn-info showEmails">Total: ${count}</div>`
                    } else {
                        return `<div class="btn btn-default disabled">No emails</div>`
                    }
                },
                lastSent: ( col, row ) => {
                    let remaining = moment.utc(moment(moment.now()).diff(moment(row.lastSent, "DD-MM-YYYY HH:mm:ss")));
                    return `<span data-toggle="tooltip" title="${remaining.format("DD-MM-YYYY HH:mm:ss")}">Send ${remaining.format('D')} days ${remaining.format('H')} hours ago</span>`
                },
                blockedTill: ( col, row ) => {
                    let remaining = moment.utc(moment(row.blockedTill,"DD-MM-YYYY HH:mm:ss").diff(moment(row.lastSent, "DD-MM-YYYY HH:mm:ss")));
                    return `Remaining ${remaining.format('D')} days ${remaining.format('H')} hours`
                },
                actions: ( col, row ) => {
                    return `<div style="margin-right: 5px;" class="btn btn-danger">Block</div>
                            <div class="btn btn-danger">Remove</div>`
                }
            }
        })
            .on("loaded.rs.jquery.bootgrid", function (e) {
                $('[data-toggle="tooltip"]').tooltip();

                $('.showEmails').on('click', () => $('#emails').modal('show'))
            });
    });
</script>

<style>
    [data-column-id="actions"]{
        width: 180px;
    }
</style>

</body>
</html>